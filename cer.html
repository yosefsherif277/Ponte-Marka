<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Certificates</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    margin:0;
    height:100vh;
    overflow:hidden;
    background:#e9e9e9;
}
.container-fluid,.row{height:100%;}

/* ================= TOP BAR ================= */
.top-bar{
    position:fixed;
    top:15px;
    left:0;
    right:0;
    padding:0 20px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    z-index:4000;
    transition:opacity .3s ease, transform .3s ease;
}
.top-bar.hidden{
    opacity:0;
    transform:translateY(-20px);
    pointer-events:none;
}

/* BACK BUTTON */
.back-btn{
    padding:10px 24px;
    font-size:1.05rem;
    font-weight:600;
    color:#1f2937;
    background:linear-gradient(135deg,#e5e7eb,#d1d5db);
    border:none;
    border-radius:10px;
    transition:background .3s ease,color .3s ease;
}
.back-btn:hover{
    background:linear-gradient(135deg,#9ca3af,#6b7280);
    color:#fff;
}

/* LANG SELECT */
.lang-box{width:170px;}
.lang-box select{
    border-radius:12px;
    padding:10px 12px;
    font-weight:600;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
}

/* ================= LEFT ================= */
.left-section{
    background:#f5f5f5;
    padding:40px;
    display:flex;
    flex-direction:column;
    justify-content:center;
}
.left-content{
    max-width:420px;
    margin:0 auto;
    text-align:center;
}
.left-content h1{
    font-size:1.5rem;
    font-weight:800;
    color:#1f2937;
    margin-bottom:14px;
}
.divider{
    width:60px;
    height:4px;
    background:linear-gradient(90deg,#9ca3af,#d1d5db);
    border-radius:10px;
    margin:0 auto 18px;
}
.left-content p{
    font-size:1.15rem;
    line-height:1.9;
    color:#4b5563;
    padding:16px 18px;
    border-radius:14px;
}

/* ================= RIGHT ================= */
.right-section{
    display:flex;
    justify-content:center;
    align-items:center;
}
.collage{
    position:relative;
    width:75%;
    height:75%;
    background:#fff;
    border-radius:20px;
    padding:30px;
}
.cert{
    position:absolute;
    width:120px;
    height:160px;
    background:#fff;
    padding:8px;
    border-radius:12px;
    box-shadow:0 15px 30px rgba(0,0,0,.2);
    cursor:pointer;
    transition:.35s;
}
.cert img{
    width:100%;
    height:100%;
    object-fit:contain;
}
.cert:hover{
    transform:scale(1.15) rotate(0deg)!important;
    z-index:10;
}

/* ================= MODAL ================= */
.modal-content{background:#000;}
.modal-img{
    width:100%;
    height:100%;
    object-fit:contain;
}

/* Ø§Ù„Ø£Ø³Ù‡Ù… */
.nav-btn{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    font-size:50px;
    color:#fff;
    cursor:pointer;
    z-index:10;
}
.nav-prev{left:20px;}
.nav-next{right:20px;}

.counter{
    position:absolute;
    bottom:15px;
    left:50%;
    transform:translateX(-50%);
    color:#fff;
}

/* âœ… FIX: Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ */
.modal .btn-danger{
    z-index:20;
}

/* ================= MOBILE ================= */
@media(max-width:768px){
    body{
        overflow:auto;
        height:auto;
    }
    .row{flex-direction:column;}
    .left-section{
        padding-top:120px;
        text-align:center;
    }
    .collage{
        width:95%;
        height:400px;
    }
    .cert{
        width:90px;
        height:120px;
    }
}
</style>
</head>

<body>

<!-- ===== TOP BAR ===== -->
<div class="top-bar" id="topBar">
    <button class="back-btn" id="backText" onclick="history.back()"></button>

    <div class="lang-box">
        <select id="langSelect" class="form-select">
            <option value="ar">ðŸ‡¸ðŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            <option value="en">ðŸ‡¬ðŸ‡§ English</option>
            <option value="it">ðŸ‡®ðŸ‡¹ Italiano</option>
        </select>
    </div>
</div>

<div class="container-fluid">
<div class="row">

<!-- LEFT -->
<div class="col-md-4 left-section bg-light">
    <div class="left-content">
        <h1 id="titleText"></h1>
        <div class="divider"></div>
        <p id="descText"></p>
    </div>
</div>

<!-- RIGHT -->
<div class="col-md-8 right-section bg-light">
    <div class="collage" id="collage"></div>
</div>

</div>
</div>

<!-- MODAL -->
<div class="modal fade" id="imageModal" tabindex="-1">
<div class="modal-dialog modal-fullscreen">
<div class="modal-content">
<div class="modal-body position-relative">

    <span class="nav-btn nav-prev" onclick="prevImage()">&#10094;</span>
    <img id="modalImage" class="modal-img">
    <span class="nav-btn nav-next" onclick="nextImage()">&#10095;</span>
    <div class="counter" id="counter"></div>

</div>
<button class="btn btn-danger position-absolute top-0 end-0 m-3" data-bs-dismiss="modal">âœ–</button>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ===== LANGUAGE ===== */
const langSelect = document.getElementById("langSelect");

function loadLang(lang){
    fetch(`lang/${lang}.json`)
    .then(r=>r.json())
    .then(t=>{
        backText.textContent = t.back;
        titleText.textContent = t.title;
        descText.textContent = t.desc;
        document.documentElement.dir = t.dir;
    });
}
loadLang("ar");
langSelect.addEventListener("change",()=>loadLang(langSelect.value));

/* ===== COLLAGE ===== */
const collage = document.getElementById("collage");
const modalImage = document.getElementById("modalImage");
const counter = document.getElementById("counter");
const modalEl = document.getElementById("imageModal");
const modal = new bootstrap.Modal(modalEl);

let images = [], currentIndex = 0;

function buildCollage(){
    collage.innerHTML="";
    images=[];
    const W=collage.clientWidth-140;
    const H=collage.clientHeight-180;

    for(let i=1;i<=50;i++){
        images.push({
            thumb:`images-small/cert${i}.webp`,
            full:`images-full/cert${i}.jpg`,
            x:Math.random()*W,
            y:Math.random()*H,
            rotate:Math.random()*20-10
        });
    }

    images.forEach((img,i)=>{
        const cert=document.createElement("div");
        cert.className="cert";
        cert.style.left=img.x+"px";
        cert.style.top=img.y+"px";
        cert.style.transform=`rotate(${img.rotate}deg)`;
        cert.innerHTML=`<img src="${img.thumb}">`;
        cert.onclick=()=>openModal(i);
        collage.appendChild(cert);
    });
}

function openModal(i){
    currentIndex=i;
    updateModal();
    topBar.classList.add("hidden"); // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    modal.show();
}

modalEl.addEventListener("hidden.bs.modal",()=>{
    topBar.classList.remove("hidden"); // Ø±Ø¬ÙˆØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
});

function updateModal(){
    modalImage.src=images[currentIndex].full;
    counter.textContent=`${currentIndex+1} / ${images.length}`;
}
function nextImage(){
    currentIndex=(currentIndex+1)%images.length;
    updateModal();
}
function prevImage(){
    currentIndex=(currentIndex-1+images.length)%images.length;
    updateModal();
}

window.addEventListener("load",buildCollage);
window.addEventListener("resize",buildCollage);

/* ===== MOBILE SCROLL HIDE/SHOW TOP BAR ===== */
const topBar = document.getElementById("topBar");
let lastScroll = 0;

window.addEventListener("scroll",()=>{
    if(window.innerWidth > 768) return;

    const currentScroll = window.pageYOffset;
    if(currentScroll > lastScroll && currentScroll > 60){
        topBar.classList.add("hidden");
    }else{
        topBar.classList.remove("hidden");
    }
    lastScroll = currentScroll;
});
</script>

</body>
</html>
